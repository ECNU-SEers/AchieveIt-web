{"remainingRequest":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\babel-loader\\lib\\index.js!D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DownLoad\\git\\achieve\\AchieveIt-web\\src\\components\\base\\table\\lin-table.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\src\\components\\base\\table\\lin-table.vue","mtime":1584099524199},{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance\"); }\n\nfunction _iterableToArray(iter) { if (Symbol.iterator in Object(iter) || Object.prototype.toString.call(iter) === \"[object Arguments]\") return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = new Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n// import Sortable from 'sortablejs'\n// import FileSaver from 'file-saver'\nexport default {\n  props: {\n    tableColumn: {\n      // 表头名称\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    tableData: {\n      // 表格数据\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    operate: {\n      // 自定义按键及绑定方法\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    customColumn: {\n      // 定制要展示的列\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    fixedLeftList: {\n      // 左侧固定列\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    fixedRightList: {\n      // 右侧固定列\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    },\n    type: {\n      // 是否开启表格多选\n      type: String,\n      default: null\n    },\n    index: {\n      // 是否显示索引\n      index: String,\n      default: ''\n    },\n    highlightCurrentRow: {\n      // 是否开启表格单选\n      type: Boolean,\n      default: false\n    },\n    loading: {\n      // 动画加载\n      type: Boolean,\n      default: false\n    },\n    loadingText: {\n      // 动画提示\n      type: String,\n      default: ''\n    },\n    loadingIcon: {\n      // 动画图标\n      type: String,\n      default: 'el-icon-loading'\n    },\n    loadingBG: {\n      // 动画背景色\n      type: String,\n      default: 'rgba(255,255,255,0.5)'\n    },\n    pagination: {\n      // 分页\n      type: [Object, Boolean],\n      default: false\n    },\n    border: {\n      // 边框\n      type: Boolean,\n      default: false\n    }\n  },\n  data: function data() {\n    return {\n      filterTableColumn: [],\n      // 定制展示的列\n      currentPage: 1,\n      // 当前选中页\n      currentData: [],\n      // 每次切换页码的时候要给table传入不同的数据\n      selectedTableData: [],\n      // 多选选中的数据\n      currentRow: null,\n      // 单选选中的数据\n      oldVal: [],\n      // 上一次选中的数据\n      oldKey: [],\n      // 上一次选中数据的key\n      currentIndex: 1,\n      // 当前索引，切换页面的时候需要重新计算\n      rowClassName: '' // 行样式\n\n    };\n  },\n  created: function created() {},\n  beforeMount: function beforeMount() {\n    // 先放在session里，因为每次切换页码table都会重新渲染，之前选中都数据就丢失了  sessionstorage在create里面打包会提示undefined\n    sessionStorage.setItem('selectedTableData', JSON.stringify([]));\n  },\n  methods: {\n    // 开发者自定义的函数\n    buttonMethods: function buttonMethods(func, index, row) {\n      var _this = this;\n\n      var methods = this.$options.methods;\n      methods[func](_this, index, row);\n    },\n    // 行内编辑\n    handleEdit: function handleEdit(_this, index, row) {\n      _this.$emit('handleEdit', {\n        index: index,\n        row: row\n      });\n    },\n    // 行内删除\n    handleDelete: function handleDelete(_this, index, row) {\n      _this.$emit('handleDelete', {\n        index: index,\n        row: row\n      });\n    },\n    // 多选-选中checkbox\n    toggleSelection: function toggleSelection(rows, flag) {\n      var _this2 = this;\n\n      if (rows) {\n        rows.forEach(function (row) {\n          _this2.$refs.linTable.toggleRowSelection(row, flag);\n        });\n      } else {\n        this.$refs.linTable.clearSelection();\n      }\n    },\n    // 全选-取消全选\n    selectAll: function selectAll(val) {\n      this.oldKey = val.map(function (item) {\n        return item.key;\n      });\n    },\n    // 单选\n    handleCurrentChange: function handleCurrentChange(val, oldVal) {\n      this.currentRow = val;\n      this.$emit('handleCurrentChange', {\n        val: val,\n        oldVal: oldVal\n      });\n    },\n    // 单击某一行\n    rowClick: function rowClick(row) {\n      // eslint-disable-line\n      // 选中-多选\n      if (!this.oldKey.includes(row.key)) {\n        this.oldKey.push(row.key);\n        var data = this.oldVal.concat(row);\n        this.handleSelectionChange(data); // 选中checkbox\n\n        this.toggleSelection(this.currentData.filter(function (item) {\n          return item.key === row.key;\n        })); // 取消选中\n      } else {\n        this.oldKey = this.oldKey.filter(function (item) {\n          return item !== row.key;\n        });\n\n        var _data = this.oldVal.filter(function (item) {\n          return item.key !== row.key;\n        });\n\n        this.handleSelectionChange(_data);\n        this.toggleSelection(this.currentData.filter(function (item) {\n          return item.key === row.key;\n        }), false);\n      } // 选中-单选\n\n\n      if (this.currentOldRow && this.currentOldRow.key === row.key) {\n        // 取消单选选中\n        this.$refs.linTable.setCurrentRow();\n        this.currentOldRow = null;\n        return;\n      }\n\n      this.currentOldRow = row;\n    },\n    // 切换当前页\n    currentChange: function currentChange(page) {\n      var _this3 = this;\n\n      var currentSelectedData = [];\n      this.oldVal = [];\n      this.currentPage = page;\n      this.selectedTableData = JSON.parse(sessionStorage.getItem('selectedTableData'));\n      this.currentData = this.tableData.filter(function (item, index) {\n        return index >= (_this3.currentPage - 1) * _this3.pagination.pageSize && index < _this3.currentPage * _this3.pagination.pageSize;\n      }); // eslint-disable-line\n\n      this.$emit('currentChange', page); // 已选中的数据打勾\n\n      this.selectedTableData.forEach(function (item) {\n        for (var i = 0; i < _this3.currentData.length; i++) {\n          if (_this3.currentData[i].key === item.key) {\n            // 切换页码重新计算oldVal\n            _this3.oldVal.push(_this3.currentData[i]); // 需要打勾的数据\n\n\n            currentSelectedData.push(_this3.currentData[i]);\n          }\n        }\n      });\n      this.$nextTick(function () {\n        _this3.toggleSelection(currentSelectedData);\n      }); // 切换行索引\n\n      this.currentIndex = (this.currentPage - 1) * this.pagination.pageSize + 1;\n    },\n    // checkbox触发函数\n    handleSelectionChange: function handleSelectionChange(val) {\n      var valKeys = val.map(function (item) {\n        return item.key;\n      });\n      var oldValKeys = this.oldVal.map(function (item) {\n        return item.key;\n      });\n      this.selectedTableData = JSON.parse(sessionStorage.getItem('selectedTableData')); // 一条数据都没选中\n\n      if (this.selectedTableData.length === 0) {\n        this.selectedTableData = this.selectedTableData.concat(val);\n        this.$emit('selection-change', this.selectedTableData);\n        this.oldVal = _toConsumableArray(val);\n        sessionStorage.setItem('selectedTableData', JSON.stringify(this.selectedTableData));\n        return;\n      } // 判断是选中数据还是取消选中\n\n\n      if (valKeys.length < oldValKeys.length) {\n        var delKey = oldValKeys.filter(function (item) {\n          return !valKeys.includes(item);\n        });\n        this.selectedTableData = this.selectedTableData.filter(function (item) {\n          return !delKey.includes(item.key);\n        });\n        this.$emit('selection-change', this.selectedTableData);\n      } else {\n        var addKey = valKeys.filter(function (item) {\n          return !oldValKeys.includes(item);\n        });\n        var addVal = val.filter(function (item) {\n          return addKey.includes(item.key);\n        });\n        this.selectedTableData = this.selectedTableData.concat(addVal);\n        this.$emit('selection-change', this.selectedTableData);\n      }\n\n      sessionStorage.setItem('selectedTableData', JSON.stringify(this.selectedTableData));\n      this.oldVal = _toConsumableArray(val);\n    }\n  },\n  watch: {\n    fixedLeftList: {\n      handler: function handler() {\n        var _this4 = this;\n\n        // eslint-disable-line\n        this.filterTableColumn.map(function (item, index) {\n          if (_this4.fixedLeftList.indexOf(item.label) > -1) {\n            _this4.$set(_this4.filterTableColumn[index], 'fixed', 'left');\n          } else if (_this4.fixedRightList.indexOf(item.label) === -1) {\n            _this4.$set(_this4.filterTableColumn[index], 'fixed', false);\n          }\n\n          return '';\n        });\n      },\n      deep: true,\n      immediate: true\n    },\n    fixedRightList: {\n      handler: function handler() {\n        var _this5 = this;\n\n        // eslint-disable-line\n        this.filterTableColumn.map(function (item, index) {\n          if (_this5.fixedRightList.indexOf(item.label) > -1) {\n            _this5.$set(_this5.filterTableColumn[index], 'fixed', 'right');\n          } else if (_this5.fixedLeftList.indexOf(item.label) === -1) {\n            _this5.$set(_this5.filterTableColumn[index], 'fixed', false);\n          }\n\n          return '';\n        });\n      },\n      deep: true,\n      immediate: true\n    },\n    customColumn: {\n      handler: function handler(val) {\n        if (val.length > 1) {\n          this.filterTableColumn = this.tableColumn.filter(function (v) {\n            return val.indexOf(v.label) > -1;\n          });\n        }\n      },\n      deep: true\n    },\n    tableData: {\n      handler: function handler() {\n        var _this6 = this;\n\n        // 传了分页配置\n        if (this.pagination && this.pagination.pageSize) {\n          this.currentData = this.tableData.filter(function (item, index) {\n            return index < _this6.pagination.pageSize;\n          });\n        } else {\n          this.currentData = this.tableData;\n        }\n      },\n      deep: true,\n      immediate: true\n    },\n    tableColumn: {\n      handler: function handler() {\n        var _this7 = this;\n\n        // 如果一开始没有传要展示的列 就默认全展示\n        if (this.customColumn.length > 1) {\n          this.filterTableColumn = this.tableColumn.filter(function (v) {\n            return _this7.customColumn.indexOf(v.label) > -1;\n          });\n        } else {\n          this.filterTableColumn = this.tableColumn;\n        }\n      },\n      deep: true,\n      immediate: true\n    }\n  }\n};",{"version":3,"sources":["lin-table.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n  <div class=\"lin-table\">\r\n    <el-table\r\n      ref=\"linTable\"\r\n      v-loading=\"loading\"\r\n      stripe\r\n      row-key=\"id\"\r\n      :border=\"border\"\r\n      :data=\"currentData\"\r\n      :highlight-current-row=\"highlightCurrentRow ? true : false\"\r\n      :element-loading-text=\"loadingText\"\r\n      :element-loading-spinner=\"loadingIcon\"\r\n      :element-loading-background=\"loadingBG\"\r\n      :row-class-name=\"rowClassName\"\r\n      @current-change=\"handleCurrentChange\"\r\n      @selection-change=\"handleSelectionChange\"\r\n      @select-all=\"selectAll\"\r\n      @row-click=\"rowClick\"\r\n    >\r\n      <el-table-column v-if=\"type\" :type=\"type\" width=\"55\"></el-table-column>\r\n      <el-table-column v-if=\"index\" :type=\"index\" :index=\"currentIndex\" width=\"55\"></el-table-column>\r\n      <el-table-column\r\n        v-for=\"item in filterTableColumn\"\r\n        :key=\"item.id\"\r\n        :prop=\"item.prop\"\r\n        :label=\"item.label\"\r\n        :show-overflow-tooltip=\"true\"\r\n        :filters=\"item.filters ? item.filters : null\"\r\n        :filter-method=\"item.filterMethod ? item.filterMethod : null\"\r\n        :column-key=\"item.filterMethod ? item.prop : null\"\r\n        :formatter=\"item.formatter ? item.formatter : null\"\r\n        :sortable=\"item.sortable ? item.sortable : false\"\r\n        :fixed=\"item.fixed ? item.fixed : false\"\r\n        :width=\"item.width ? item.width : ''\"\r\n      ></el-table-column>\r\n      <el-table-column v-if=\"operate.length > 0\" label=\"操作\" fixed=\"right\" width=\"175\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button\r\n            v-for=\"(item, index) in operate\"\r\n            :type=\"item.type\"\r\n            plain\r\n            :key=\"index\"\r\n            size=\"mini\"\r\n            v-permission=\"{ permission: item.permission ? item.permission : '', type: 'disabled' }\"\r\n            @click.native.prevent.stop=\"buttonMethods(item.func, scope.$index, scope.row)\"\r\n            >{{ item.name }}</el-button\r\n          >\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <el-pagination\r\n      class=\"pagination\"\r\n      v-if=\"pagination\"\r\n      background\r\n      layout=\"prev, pager, next\"\r\n      :page-size=\"pagination.pageSize ? pagination.pageSize : 10\"\r\n      :total=\"pagination.pageTotal ? pagination.pageTotal : null\"\r\n      @current-change=\"currentChange\"\r\n    ></el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n// import Sortable from 'sortablejs'\r\n// import FileSaver from 'file-saver'\r\n\r\nexport default {\r\n  props: {\r\n    tableColumn: {\r\n      // 表头名称\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    tableData: {\r\n      // 表格数据\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    operate: {\r\n      // 自定义按键及绑定方法\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    customColumn: {\r\n      // 定制要展示的列\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    fixedLeftList: {\r\n      // 左侧固定列\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    fixedRightList: {\r\n      // 右侧固定列\r\n      type: Array,\r\n      default: () => [],\r\n    },\r\n    type: {\r\n      // 是否开启表格多选\r\n      type: String,\r\n      default: null,\r\n    },\r\n    index: {\r\n      // 是否显示索引\r\n      index: String,\r\n      default: '',\r\n    },\r\n    highlightCurrentRow: {\r\n      // 是否开启表格单选\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    loading: {\r\n      // 动画加载\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n    loadingText: {\r\n      // 动画提示\r\n      type: String,\r\n      default: '',\r\n    },\r\n    loadingIcon: {\r\n      // 动画图标\r\n      type: String,\r\n      default: 'el-icon-loading',\r\n    },\r\n    loadingBG: {\r\n      // 动画背景色\r\n      type: String,\r\n      default: 'rgba(255,255,255,0.5)',\r\n    },\r\n    pagination: {\r\n      // 分页\r\n      type: [Object, Boolean],\r\n      default: false,\r\n    },\r\n    border: {\r\n      // 边框\r\n      type: Boolean,\r\n      default: false,\r\n    },\r\n  },\r\n  data() {\r\n    return {\r\n      filterTableColumn: [], // 定制展示的列\r\n      currentPage: 1, // 当前选中页\r\n      currentData: [], // 每次切换页码的时候要给table传入不同的数据\r\n      selectedTableData: [], // 多选选中的数据\r\n      currentRow: null, // 单选选中的数据\r\n      oldVal: [], // 上一次选中的数据\r\n      oldKey: [], // 上一次选中数据的key\r\n      currentIndex: 1, // 当前索引，切换页面的时候需要重新计算\r\n      rowClassName: '', // 行样式\r\n    }\r\n  },\r\n  created() {},\r\n  beforeMount() {\r\n    // 先放在session里，因为每次切换页码table都会重新渲染，之前选中都数据就丢失了  sessionstorage在create里面打包会提示undefined\r\n    sessionStorage.setItem('selectedTableData', JSON.stringify([]))\r\n  },\r\n  methods: {\r\n    // 开发者自定义的函数\r\n    buttonMethods(func, index, row) {\r\n      const _this = this\r\n      const { methods } = this.$options\r\n      methods[func](_this, index, row)\r\n    },\r\n    // 行内编辑\r\n    handleEdit(_this, index, row) {\r\n      _this.$emit('handleEdit', { index, row })\r\n    },\r\n    // 行内删除\r\n    handleDelete(_this, index, row) {\r\n      _this.$emit('handleDelete', { index, row })\r\n    },\r\n    // 多选-选中checkbox\r\n    toggleSelection(rows, flag) {\r\n      if (rows) {\r\n        rows.forEach(row => {\r\n          this.$refs.linTable.toggleRowSelection(row, flag)\r\n        })\r\n      } else {\r\n        this.$refs.linTable.clearSelection()\r\n      }\r\n    },\r\n    // 全选-取消全选\r\n    selectAll(val) {\r\n      this.oldKey = val.map(item => item.key)\r\n    },\r\n    // 单选\r\n    handleCurrentChange(val, oldVal) {\r\n      this.currentRow = val\r\n      this.$emit('handleCurrentChange', { val, oldVal })\r\n    },\r\n    // 单击某一行\r\n    rowClick(row) {\r\n      // eslint-disable-line\r\n      // 选中-多选\r\n      if (!this.oldKey.includes(row.key)) {\r\n        this.oldKey.push(row.key)\r\n        const data = this.oldVal.concat(row)\r\n        this.handleSelectionChange(data)\r\n        // 选中checkbox\r\n        this.toggleSelection(this.currentData.filter(item => item.key === row.key))\r\n        // 取消选中\r\n      } else {\r\n        this.oldKey = this.oldKey.filter(item => item !== row.key)\r\n        const data = this.oldVal.filter(item => item.key !== row.key)\r\n        this.handleSelectionChange(data)\r\n        this.toggleSelection(this.currentData.filter(item => item.key === row.key), false)\r\n      }\r\n      // 选中-单选\r\n      if (this.currentOldRow && this.currentOldRow.key === row.key) {\r\n        // 取消单选选中\r\n        this.$refs.linTable.setCurrentRow()\r\n        this.currentOldRow = null\r\n        return\r\n      }\r\n      this.currentOldRow = row\r\n    },\r\n    // 切换当前页\r\n    currentChange(page) {\r\n      const currentSelectedData = []\r\n      this.oldVal = []\r\n      this.currentPage = page\r\n      this.selectedTableData = JSON.parse(sessionStorage.getItem('selectedTableData'))\r\n      this.currentData = this.tableData.filter(\r\n        (item, index) => index >= (this.currentPage - 1) * this.pagination.pageSize\r\n          && index < this.currentPage * this.pagination.pageSize,\r\n      ) // eslint-disable-line\r\n      this.$emit('currentChange', page)\r\n      // 已选中的数据打勾\r\n      this.selectedTableData.forEach(item => {\r\n        for (let i = 0; i < this.currentData.length; i++) {\r\n          if (this.currentData[i].key === item.key) {\r\n            // 切换页码重新计算oldVal\r\n            this.oldVal.push(this.currentData[i])\r\n            // 需要打勾的数据\r\n            currentSelectedData.push(this.currentData[i])\r\n          }\r\n        }\r\n      })\r\n      this.$nextTick(() => {\r\n        this.toggleSelection(currentSelectedData)\r\n      })\r\n      // 切换行索引\r\n      this.currentIndex = (this.currentPage - 1) * this.pagination.pageSize + 1\r\n    },\r\n    // checkbox触发函数\r\n    handleSelectionChange(val) {\r\n      const valKeys = val.map(item => item.key)\r\n      const oldValKeys = this.oldVal.map(item => item.key)\r\n      this.selectedTableData = JSON.parse(sessionStorage.getItem('selectedTableData'))\r\n      // 一条数据都没选中\r\n      if (this.selectedTableData.length === 0) {\r\n        this.selectedTableData = this.selectedTableData.concat(val)\r\n        this.$emit('selection-change', this.selectedTableData)\r\n        this.oldVal = [...val]\r\n        sessionStorage.setItem('selectedTableData', JSON.stringify(this.selectedTableData))\r\n        return\r\n      }\r\n      // 判断是选中数据还是取消选中\r\n      if (valKeys.length < oldValKeys.length) {\r\n        const delKey = oldValKeys.filter(item => !valKeys.includes(item))\r\n        this.selectedTableData = this.selectedTableData.filter(item => !delKey.includes(item.key))\r\n        this.$emit('selection-change', this.selectedTableData)\r\n      } else {\r\n        const addKey = valKeys.filter(item => !oldValKeys.includes(item))\r\n        const addVal = val.filter(item => addKey.includes(item.key))\r\n        this.selectedTableData = this.selectedTableData.concat(addVal)\r\n        this.$emit('selection-change', this.selectedTableData)\r\n      }\r\n      sessionStorage.setItem('selectedTableData', JSON.stringify(this.selectedTableData))\r\n      this.oldVal = [...val]\r\n    },\r\n    // 拖拽\r\n    // setDrag() {\r\n    //   const el = document.querySelectorAll('.el-table__body-wrapper > table > tbody')[0]\r\n    //   this.rowClassName = 'rowClassName' // 设置行样式，添加移动手势\r\n    //   this.sortable = Sortable.create(el, {\r\n    //     setData(dataTransfer) {\r\n    //       dataTransfer.setData('Text', '')\r\n    //     },\r\n    //     onEnd: (evt) => {\r\n    //       const dragData = [...this.currentData]\r\n    //       let { oldIndex, newIndex } = evt\r\n    //       if (this.pagination) {\r\n    //         oldIndex = evt.oldIndex * this.currentPage\r\n    //         newIndex = evt.newIndex * this.currentPage\r\n    //       }\r\n    //       dragData[oldIndex] = this.currentData[newIndex]\r\n    //       dragData[newIndex] = this.currentData[oldIndex]\r\n    //       this.$emit('getDragData', { dragData, oldIndex, newIndex })\r\n    //     },\r\n    //   })\r\n    // },\r\n    // 导出excel\r\n    // exportExcel(fileName = 'sheet') {\r\n    //   const targetTable = this.$XLSX.utils.table_to_book(document.querySelectorAll('.el-table__body-wrapper > table')[0])\r\n    //   const writeTable = this.$XLSX.write(targetTable, { bookType: 'xlsx', bookSST: true, type: 'array' })\r\n    //   try {\r\n    //     FileSaver.saveAs(new Blob([writeTable], { type: 'application/octet-stream' }), `${fileName}.xlsx`)\r\n    //   } catch (e) { if (typeof console !== 'undefined') console.log(e, writeTable) }\r\n    //   return writeTable\r\n    // },\r\n    // 导出csv\r\n    // exportCsv(fileName = 'sheet') {\r\n    //   const targetTable = this.$XLSX.utils.table_to_book(document.querySelectorAll('.el-table__body-wrapper > table')[0])\r\n    //   const writeTable = this.$XLSX.write(targetTable, { bookType: 'csv', bookSST: true, type: 'array' })\r\n    //   try {\r\n    //     FileSaver.saveAs(new Blob([writeTable], { type: 'application/octet-stream' }), `${fileName}.csv`)\r\n    //   } catch (e) { if (typeof console !== 'undefined') console.log(e, writeTable) }\r\n    //   return writeTable\r\n    // },\r\n  },\r\n  watch: {\r\n    fixedLeftList: {\r\n      handler() {\r\n        // eslint-disable-line\r\n        this.filterTableColumn.map((item, index) => {\r\n          if (this.fixedLeftList.indexOf(item.label) > -1) {\r\n            this.$set(this.filterTableColumn[index], 'fixed', 'left')\r\n          } else if (this.fixedRightList.indexOf(item.label) === -1) {\r\n            this.$set(this.filterTableColumn[index], 'fixed', false)\r\n          }\r\n          return ''\r\n        })\r\n      },\r\n      deep: true,\r\n      immediate: true,\r\n    },\r\n    fixedRightList: {\r\n      handler() {\r\n        // eslint-disable-line\r\n        this.filterTableColumn.map((item, index) => {\r\n          if (this.fixedRightList.indexOf(item.label) > -1) {\r\n            this.$set(this.filterTableColumn[index], 'fixed', 'right')\r\n          } else if (this.fixedLeftList.indexOf(item.label) === -1) {\r\n            this.$set(this.filterTableColumn[index], 'fixed', false)\r\n          }\r\n          return ''\r\n        })\r\n      },\r\n      deep: true,\r\n      immediate: true,\r\n    },\r\n    customColumn: {\r\n      handler(val) {\r\n        if (val.length > 1) {\r\n          this.filterTableColumn = this.tableColumn.filter(v => val.indexOf(v.label) > -1)\r\n        }\r\n      },\r\n      deep: true,\r\n    },\r\n    tableData: {\r\n      handler() {\r\n        // 传了分页配置\r\n        if (this.pagination && this.pagination.pageSize) {\r\n          this.currentData = this.tableData.filter((item, index) => index < this.pagination.pageSize)\r\n        } else {\r\n          this.currentData = this.tableData\r\n        }\r\n      },\r\n      deep: true,\r\n      immediate: true,\r\n    },\r\n    tableColumn: {\r\n      handler() {\r\n        // 如果一开始没有传要展示的列 就默认全展示\r\n        if (this.customColumn.length > 1) {\r\n          this.filterTableColumn = this.tableColumn.filter(v => this.customColumn.indexOf(v.label) > -1)\r\n        } else {\r\n          this.filterTableColumn = this.tableColumn\r\n        }\r\n      },\r\n      deep: true,\r\n      immediate: true,\r\n    },\r\n  },\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.lin-table {\r\n  position: relative;\r\n}\r\n\r\n.sort-input {\r\n  width: 50px;\r\n  background: none;\r\n  justify-content: space-around;\r\n}\r\n\r\n.table-edit {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  width: 135px;\r\n}\r\n\r\n.cell-edit-input .el-input,\r\n.el-input__inner {\r\n  width: 125px;\r\n}\r\n\r\n.cell-icon {\r\n  cursor: pointer;\r\n  color: #3963bc;\r\n  margin-left: 5px;\r\n}\r\n\r\n.pagination {\r\n  display: flex;\r\n  justify-content: flex-end;\r\n  margin-right: -10px;\r\n  margin-top: 15px;\r\n}\r\n</style>\r\n\r\n<style>\r\n.lin-table .rowClassName {\r\n  cursor: move !important;\r\n}\r\n</style>\r\n"],"sourceRoot":"src/components/base/table"}]}