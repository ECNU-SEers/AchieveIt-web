{"remainingRequest":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\DownLoad\\git\\achieve\\AchieveIt-web\\src\\views\\login\\Login.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\src\\views\\login\\Login.vue","mtime":1584099524347},{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\DownLoad\\git\\achieve\\AchieveIt-web\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {mapActions, mapMutations} from 'vuex';\nimport User from '@/sys/models/user';\nimport Utils from '@/sys/utils/util';\nexport default {\n  data() {\n    return {\n      loading: false, // 加载动画\n      wait: 2000, // 2000ms之内不能重复发起请求\n      throttleLogin: null, // 节流登录\n      form: {\n        username: 'root',\n        password: '123456',\n      },\n      rules: {\n        account: [{\n          required: true,\n          message: \"请输入账号\"\n        }],\n        password: [{\n          required: true, message: \"请输入密码\"\n        }, {\n          min: 6, message: \"长度至少为6位\"\n        }]\n      }\n    };\n  },\n  methods: {\n    async userLogin() {\n      const {username, password} = this.form;\n      await this.login(username, password);\n    },\n    async touristLogin() {\n      await this.login();\n    },\n    async login(username, password) {\n      try {\n        this.loading = true;\n        await User.getToken(username, password);\n        await this.getInformation();\n        this.loading = false;\n        this.$router.push('/about');\n        this.$message.success('登录成功');\n      } catch (e) {\n        this.loading = false;\n        console.log(e);\n      }\n    },\n    async getInformation() {\n      try {\n        // 尝试获取当前用户信息\n        const user = await User.getPermissions();\n        this.setUserAndState(user);\n        this.setUserPermissions(user.permissions);\n      } catch (e) {\n        console.log(e);\n      }\n    },\n    ...mapActions(['setUserAndState']),\n    ...mapMutations({\n      setUserPermissions: 'SET_USER_PERMISSIONS',\n    }),\n  },\n  created() {\n    // 节流登录\n    this.throttleLogin = Utils.throttle(this.login, this.wait);\n  },\n};\n",{"version":3,"sources":["Login.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Login.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\r\n    <div class=\"container\">\r\n        <p class=\"title\">AchieveIt 软件项目管理平台</p>\r\n        <el-card class=\"login-box bg-translucence\" shadow=\"hover\">\r\n            <el-form ref=\"form\" label-position='left' :model=\"form\" :rules=\"rules\" label-width='60'>\r\n                <el-form-item label=\"账号:\" prop=\"account\">\r\n                    <el-input v-model=\"form.username\"/>\r\n                </el-form-item>\r\n                <el-form-item label=\"密码:\" prop=\"password\">\r\n                    <el-input v-model=\"form.password\" type=\"password\"/>\r\n                </el-form-item>\r\n            </el-form>\r\n            <el-button type=\"primary\" class=\"login-btn btn\" @click=\"userLogin\"\r\n                       :loading=\"loading\" :disabled=\"loading\"\r\n            >\r\n                登录\r\n            </el-button>\r\n            <!--            <el-button class=\"tourist-btn btn\" @click=\"login\">游客登录</el-button>-->\r\n        </el-card>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n  import {mapActions, mapMutations} from 'vuex';\r\n  import User from '@/sys/models/user';\r\n  import Utils from '@/sys/utils/util';\r\n  export default {\r\n    data() {\r\n      return {\r\n        loading: false, // 加载动画\r\n        wait: 2000, // 2000ms之内不能重复发起请求\r\n        throttleLogin: null, // 节流登录\r\n        form: {\r\n          username: 'root',\r\n          password: '123456',\r\n        },\r\n        rules: {\r\n          account: [{\r\n            required: true,\r\n            message: \"请输入账号\"\r\n          }],\r\n          password: [{\r\n            required: true, message: \"请输入密码\"\r\n          }, {\r\n            min: 6, message: \"长度至少为6位\"\r\n          }]\r\n        }\r\n      };\r\n    },\r\n    methods: {\r\n      async userLogin() {\r\n        const {username, password} = this.form;\r\n        await this.login(username, password);\r\n      },\r\n      async touristLogin() {\r\n        await this.login();\r\n      },\r\n      async login(username, password) {\r\n        try {\r\n          this.loading = true;\r\n          await User.getToken(username, password);\r\n          await this.getInformation();\r\n          this.loading = false;\r\n          this.$router.push('/about');\r\n          this.$message.success('登录成功');\r\n        } catch (e) {\r\n          this.loading = false;\r\n          console.log(e);\r\n        }\r\n      },\r\n      async getInformation() {\r\n        try {\r\n          // 尝试获取当前用户信息\r\n          const user = await User.getPermissions();\r\n          this.setUserAndState(user);\r\n          this.setUserPermissions(user.permissions);\r\n        } catch (e) {\r\n          console.log(e);\r\n        }\r\n      },\r\n      ...mapActions(['setUserAndState']),\r\n      ...mapMutations({\r\n        setUserPermissions: 'SET_USER_PERMISSIONS',\r\n      }),\r\n    },\r\n    created() {\r\n      // 节流登录\r\n      this.throttleLogin = Utils.throttle(this.login, this.wait);\r\n    },\r\n  };\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n    .container {\r\n        width: 100%;\r\n        height: 100%;\r\n        background-image: url(\"../../assets/img/login-bg.jpg\");\r\n        background-size: cover;\r\n        position: fixed;\r\n    }\r\n\r\n    .title {\r\n        font-size: 48px;\r\n        margin-top: 160px;\r\n    }\r\n\r\n    .login-box {\r\n        width: 480px;\r\n        height: 320px;\r\n        margin: 80px auto;\r\n        text-align: center;\r\n    }\r\n\r\n    .bg-translucence {\r\n        background-color: rgba(255, 255, 255, .4);\r\n    }\r\n\r\n    .btn {\r\n        width: 440px;\r\n        height: 40px;\r\n    }\r\n\r\n    .login-btn {\r\n        margin-bottom: 16px;\r\n    }\r\n\r\n    .tourist-btn {\r\n        margin-left: -2px;\r\n    }\r\n</style>\r\n"]}]}